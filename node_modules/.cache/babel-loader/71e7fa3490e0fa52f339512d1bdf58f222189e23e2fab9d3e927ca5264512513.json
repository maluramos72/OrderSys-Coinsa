{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Malu\\\\Downloads\\\\OrderSys-Coinsa\\\\src\\\\components\\\\order-management-system.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Papa from \"papaparse\";\nimport html2canvas from \"html2canvas\";\nimport ExcelJS from \"exceljs\";\nimport { saveAs } from \"file-saver\";\nimport { ShoppingCart, Save, Trash2, Eye } from \"lucide-react\";\n\n/* ===========================\n   Interfaces\n   =========================== */\n\n/* ===========================\n   Product Preview\n   =========================== */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProductPreview = ({\n  product,\n  color,\n  logo,\n  logoPos,\n  imageUrl,\n  onClickPosition,\n  id\n}) => {\n  const width = 400;\n  const height = 400;\n  if (!product) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full h-full rounded-lg bg-gray-100 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-400\",\n        children: \"Selecciona un producto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: id,\n    onClick: onClickPosition,\n    style: {\n      width,\n      height,\n      backgroundColor: color,\n      borderRadius: 8,\n      position: \"relative\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      overflow: \"hidden\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      src: imageUrl || product.image,\n      alt: product.name,\n      style: {\n        maxWidth: \"100%\",\n        maxHeight: \"100%\",\n        objectFit: \"contain\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this), logo && /*#__PURE__*/_jsxDEV(\"img\", {\n      src: logo,\n      alt: \"logo\",\n      style: {\n        position: \"absolute\",\n        left: logoPos.x,\n        top: logoPos.y,\n        width: 100,\n        height: 100,\n        transform: \"translate(-50%, -50%)\",\n        pointerEvents: \"none\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n};\n\n/* ===========================\n   Main component\n   =========================== */\n_c = ProductPreview;\nconst OrderManagementSystem = () => {\n  _s();\n  const [products, setProducts] = useState([]);\n  const [selectedProduct, setSelectedProduct] = useState(null);\n  const [selectedSize, setSelectedSize] = useState(\"M\");\n  const [quantity, setQuantity] = useState(1);\n  const [logoFile, setLogoFile] = useState(null);\n  const [logoPosition, setLogoPosition] = useState({\n    x: 200,\n    y: 200\n  });\n  const [orderItems, setOrderItems] = useState([]);\n  const [customerInfo, setCustomerInfo] = useState({\n    companyName: \"\",\n    contact: \"\",\n    phone: \"\",\n    email: \"\",\n    deliveryDate: \"\"\n  });\n\n  /* ---------------------------\n     Cargar productos desde CSV\n     --------------------------- */\n  useEffect(() => {\n    fetch(\"/Products.csv\").then(r => r.text()).then(csvText => {\n      Papa.parse(csvText, {\n        header: true,\n        skipEmptyLines: true,\n        complete: result => {\n          const parsed = result.data;\n          const prods = parsed.map((row, i) => ({\n            id: i + 1,\n            name: row.name,\n            basePrice: parseFloat(row.basePrice || 0),\n            image: row.image\n          }));\n          setProducts(prods);\n          if (prods.length > 0) setSelectedProduct(prods[0]);\n        }\n      });\n    });\n  }, []);\n\n  /* ---------------------------\n     Handlers\n     --------------------------- */\n  const handleLogoUpload = e => {\n    var _e$target$files;\n    const f = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!f) return;\n    const reader = new FileReader();\n    reader.onload = () => {\n      setLogoFile(reader.result);\n      setLogoPosition({\n        x: 200,\n        y: 200\n      });\n    };\n    reader.readAsDataURL(f);\n  };\n  const handlePreviewClickPosition = e => {\n    const el = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - el.left;\n    const y = e.clientY - el.top;\n    setLogoPosition({\n      x,\n      y\n    });\n  };\n  const handleAddToOrder = () => {\n    if (!selectedProduct) return;\n    const newItem = {\n      id: Date.now(),\n      product: selectedProduct,\n      color: \"#FFFFFF\",\n      size: selectedSize,\n      quantity,\n      logo: logoFile,\n      logoPosition,\n      subtotal: selectedProduct.basePrice * quantity\n    };\n    setOrderItems(prev => [...prev, newItem]);\n    setLogoFile(null);\n    setLogoPosition({\n      x: 200,\n      y: 200\n    });\n    setQuantity(1);\n  };\n  const updateOrderItem = (id, field, value) => {\n    setOrderItems(prev => prev.map(it => {\n      if (it.id !== id) return it;\n      const updated = {\n        ...it,\n        [field]: value\n      };\n      if (field === \"quantity\") {\n        const q = Number(value) || 0;\n        updated.subtotal = updated.product.basePrice * q;\n        updated.quantity = q;\n      }\n      return updated;\n    }));\n  };\n  const removeOrderItem = id => {\n    setOrderItems(prev => prev.filter(it => it.id !== id));\n  };\n  const getTotalOrder = () => orderItems.reduce((s, it) => s + it.subtotal, 0);\n\n  /* ---------------------------\n     Export helpers\n     --------------------------- */\n  const capturePreviewAsBlob = async elementId => {\n    const el = document.getElementById(elementId);\n    if (!el) return null;\n    const canvas = await html2canvas(el, {\n      backgroundColor: null,\n      scale: 2,\n      useCORS: true\n    });\n    return new Promise(resolve => canvas.toBlob(b => resolve(b), \"image/png\"));\n  };\n  const exportOrder = async () => {\n    if (orderItems.length === 0) {\n      alert(\"No puedes guardar una orden sin productos.\");\n      return;\n    }\n    const orderId = Date.now();\n    const now = new Date();\n    const orderMeta = {\n      id: orderId,\n      customer: {\n        ...customerInfo\n      },\n      items: orderItems,\n      total: getTotalOrder(),\n      status: \"Pendiente\",\n      createdAt: now.toISOString()\n    };\n\n    // 1) Capturar previews ocultos\n    for (let i = 0; i < orderItems.length; i++) {\n      const item = orderItems[i];\n      const blob = await capturePreviewAsBlob(`hidden-preview-${item.id}`);\n      if (blob) {\n        const filename = `order-${orderId}-${i + 1}.png`;\n        saveAs(blob, filename);\n      }\n    }\n\n    // 2) Excel con datos de la orden\n    const workbook = new ExcelJS.Workbook();\n    const worksheet = workbook.addWorksheet(\"Orders\");\n    worksheet.columns = [{\n      header: \"ID\",\n      key: \"id\",\n      width: 18\n    }, {\n      header: \"companyName\",\n      key: \"companyName\",\n      width: 25\n    }, {\n      header: \"contact\",\n      key: \"contact\",\n      width: 20\n    }, {\n      header: \"phone\",\n      key: \"phone\",\n      width: 15\n    }, {\n      header: \"email\",\n      key: \"email\",\n      width: 25\n    }, {\n      header: \"deliveryDate\",\n      key: \"deliveryDate\",\n      width: 18\n    }, {\n      header: \"productName\",\n      key: \"productName\",\n      width: 25\n    }, {\n      header: \"linkImg\",\n      key: \"linkImg\",\n      width: 30\n    }, {\n      header: \"color\",\n      key: \"color\",\n      width: 10\n    }, {\n      header: \"size\",\n      key: \"size\",\n      width: 10\n    }, {\n      header: \"quantity\",\n      key: \"quantity\",\n      width: 10\n    }, {\n      header: \"basePrice\",\n      key: \"basePrice\",\n      width: 12\n    }, {\n      header: \"subtotal\",\n      key: \"subtotal\",\n      width: 12\n    }, {\n      header: \"status\",\n      key: \"status\",\n      width: 12\n    }];\n    orderItems.forEach((item, idx) => {\n      const filename = `order-${orderId}-${idx + 1}.png`;\n      worksheet.addRow({\n        id: `${orderId}-${idx + 1}`,\n        companyName: orderMeta.customer.companyName,\n        contact: orderMeta.customer.contact,\n        phone: orderMeta.customer.phone,\n        email: orderMeta.customer.email,\n        deliveryDate: orderMeta.customer.deliveryDate || \"\",\n        productName: item.product.name,\n        linkImg: filename,\n        color: item.color,\n        size: item.size,\n        quantity: item.quantity,\n        basePrice: item.product.basePrice,\n        subtotal: item.subtotal,\n        status: orderMeta.status\n      });\n    });\n    const buffer = await workbook.xlsx.writeBuffer();\n    saveAs(new Blob([buffer]), `orderData-${orderId}.xlsx`);\n    alert(`Orden ${orderId} exportada correctamente.`);\n    setOrderItems([]);\n    setCustomerInfo({\n      companyName: \"\",\n      contact: \"\",\n      phone: \"\",\n      email: \"\",\n      deliveryDate: \"\"\n    });\n  };\n\n  /* ===========================\n     JSX\n     =========================== */\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"Sistema de \\xD3rdenes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 flex items-center space-x-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        value: (selectedProduct === null || selectedProduct === void 0 ? void 0 : selectedProduct.id) || \"\",\n        onChange: e => setSelectedProduct(products.find(p => p.id === Number(e.target.value)) || null),\n        className: \"border p-2 rounded\",\n        children: products.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: p.id,\n          children: [p.name, \" ($\", p.basePrice, \")\"]\n        }, p.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        value: quantity,\n        min: 1,\n        onChange: e => setQuantity(Number(e.target.value)),\n        className: \"border p-2 w-20\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: selectedSize,\n        onChange: e => setSelectedSize(e.target.value),\n        className: \"border p-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"S\",\n          children: \"S\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"M\",\n          children: \"M\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"L\",\n          children: \"L\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: handleLogoUpload\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAddToOrder,\n        className: \"px-4 py-2 bg-blue-500 text-white rounded flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(ShoppingCart, {\n          className: \"mr-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 11\n        }, this), \" Agregar\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg p-6 shadow-lg flex flex-col items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-xl font-bold mb-4 flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(Eye, {\n          className: \"mr-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 11\n        }, this), \" Vista Previa\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this), selectedProduct ? /*#__PURE__*/_jsxDEV(ProductPreview, {\n        product: selectedProduct,\n        color: \"#FFFFFF\",\n        logo: logoFile,\n        logoPos: logoPosition,\n        onClickPosition: handlePreviewClickPosition,\n        imageUrl: selectedProduct === null || selectedProduct === void 0 ? void 0 : selectedProduct.image,\n        id: \"preview-selected\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"Selecciona un producto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6 space-y-4\",\n      children: orderItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border rounded p-4 flex items-center space-x-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: 120,\n            height: 120\n          },\n          children: /*#__PURE__*/_jsxDEV(ProductPreview, {\n            product: item.product,\n            color: item.color,\n            logo: item.logo,\n            logoPos: item.logoPosition,\n            imageUrl: item.product.image\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"font-bold\",\n            children: item.product.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Cantidad:\", \" \", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: item.quantity,\n              min: 1,\n              onChange: e => updateOrderItem(item.id, \"quantity\", Number(e.target.value)),\n              className: \"w-16 border p-1 ml-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Subtotal: $\", item.subtotal]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeOrderItem(item.id),\n            className: \"text-red-500 mt-2 flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(Trash2, {\n              size: 16,\n              className: \"mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 445,\n              columnNumber: 17\n            }, this), \" Eliminar\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 13\n        }, this)]\n      }, item.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold\",\n        children: \"Resumen de Orden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Total: $\", getTotalOrder()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: exportOrder,\n        className: \"mt-2 px-4 py-2 bg-green-500 text-white rounded flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(Save, {\n          className: \"mr-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 11\n        }, this), \" Guardar Orden\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        left: \"-9999px\",\n        top: 0\n      },\n      children: orderItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        id: `hidden-preview-${item.id}`,\n        style: {\n          width: 400,\n          height: 400\n        },\n        children: /*#__PURE__*/_jsxDEV(ProductPreview, {\n          product: item.product,\n          color: item.color,\n          logo: item.logo,\n          logoPos: item.logoPosition,\n          imageUrl: item.product.image\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 13\n        }, this)\n      }, `hidden-preview-${item.id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 341,\n    columnNumber: 5\n  }, this);\n};\n_s(OrderManagementSystem, \"KZEjrdplVD8/fYm46lJz/nh2vLE=\");\n_c2 = OrderManagementSystem;\nexport default OrderManagementSystem;\nvar _c, _c2;\n$RefreshReg$(_c, \"ProductPreview\");\n$RefreshReg$(_c2, \"OrderManagementSystem\");","map":{"version":3,"names":["React","useEffect","useState","Papa","html2canvas","ExcelJS","saveAs","ShoppingCart","Save","Trash2","Eye","jsxDEV","_jsxDEV","ProductPreview","product","color","logo","logoPos","imageUrl","onClickPosition","id","width","height","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","style","backgroundColor","borderRadius","position","display","alignItems","justifyContent","overflow","src","image","alt","name","maxWidth","maxHeight","objectFit","left","x","top","y","transform","pointerEvents","_c","OrderManagementSystem","_s","products","setProducts","selectedProduct","setSelectedProduct","selectedSize","setSelectedSize","quantity","setQuantity","logoFile","setLogoFile","logoPosition","setLogoPosition","orderItems","setOrderItems","customerInfo","setCustomerInfo","companyName","contact","phone","email","deliveryDate","fetch","then","r","text","csvText","parse","header","skipEmptyLines","complete","result","parsed","data","prods","map","row","i","basePrice","parseFloat","length","handleLogoUpload","e","_e$target$files","f","target","files","reader","FileReader","onload","readAsDataURL","handlePreviewClickPosition","el","currentTarget","getBoundingClientRect","clientX","clientY","handleAddToOrder","newItem","Date","now","size","subtotal","prev","updateOrderItem","field","value","it","updated","q","Number","removeOrderItem","filter","getTotalOrder","reduce","s","capturePreviewAsBlob","elementId","document","getElementById","canvas","scale","useCORS","Promise","resolve","toBlob","b","exportOrder","alert","orderId","orderMeta","customer","items","total","status","createdAt","toISOString","item","blob","filename","workbook","Workbook","worksheet","addWorksheet","columns","key","forEach","idx","addRow","productName","linkImg","buffer","xlsx","writeBuffer","Blob","onChange","find","p","type","min","accept","_c2","$RefreshReg$"],"sources":["C:/Users/Malu/Downloads/OrderSys-Coinsa/src/components/order-management-system.tsx"],"sourcesContent":["import React, { useEffect, useState, ChangeEvent } from \"react\";\nimport Papa from \"papaparse\";\nimport html2canvas from \"html2canvas\";\nimport ExcelJS from \"exceljs\";\nimport { saveAs } from \"file-saver\";\nimport {\n  ShoppingCart,\n  Upload,\n  Save,\n  Trash2,\n  Eye,\n  Plus,\n  FileText,\n  User,\n  ChevronLeft,\n  ChevronRight,\n} from \"lucide-react\";\n\n/* ===========================\n   Interfaces\n   =========================== */\ninterface Product {\n  id: number;\n  name: string;\n  basePrice: number;\n  image: string;\n}\n\ninterface OrderItem {\n  id: number;\n  product: Product;\n  color: \"#FFFFFF\";\n  size: string;\n  quantity: number;\n  logo: string | null;\n  logoPosition: { x: number; y: number };\n  subtotal: number;\n}\n\ninterface CustomerInfo {\n  companyName: string;\n  contact: string;\n  phone: string;\n  email: string;\n  deliveryDate: string;\n}\n\ninterface Order {\n  id: number;\n  customer: CustomerInfo;\n  items: OrderItem[];\n  total: number;\n  status: string;\n  createdAt: string;\n}\n\n/* ===========================\n   Product Preview\n   =========================== */\ntype ProductPreviewProps = {\n  product: Product | null;\n  color: \"#FFFFFF\";\n  logo: string | null;\n  logoPos: { x: number; y: number };\n  imageUrl?: string;\n  onClickPosition?: (e: React.MouseEvent<HTMLDivElement>) => void;\n  id?: string;\n};\n\nconst ProductPreview: React.FC<ProductPreviewProps> = ({\n  product,\n  color,\n  logo,\n  logoPos,\n  imageUrl,\n  onClickPosition,\n  id,\n}) => {\n  const width = 400;\n  const height = 400;\n\n  if (!product) {\n    return (\n      <div className=\"w-full h-full rounded-lg bg-gray-100 flex items-center justify-center\">\n        <p className=\"text-gray-400\">Selecciona un producto</p>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      id={id}\n      onClick={onClickPosition}\n      style={{\n        width,\n        height,\n        backgroundColor: color,\n        borderRadius: 8,\n        position: \"relative\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        overflow: \"hidden\",\n      }}\n    >\n      <img\n        src={imageUrl || product.image}\n        alt={product.name}\n        style={{ maxWidth: \"100%\", maxHeight: \"100%\", objectFit: \"contain\" }}\n      />\n      {logo && (\n        <img\n          src={logo}\n          alt=\"logo\"\n          style={{\n            position: \"absolute\",\n            left: logoPos.x,\n            top: logoPos.y,\n            width: 100,\n            height: 100,\n            transform: \"translate(-50%, -50%)\",\n            pointerEvents: \"none\",\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\n/* ===========================\n   Main component\n   =========================== */\nconst OrderManagementSystem: React.FC = () => {\n  const [products, setProducts] = useState<Product[]>([]);\n  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);\n  const [selectedSize, setSelectedSize] = useState<string>(\"M\");\n  const [quantity, setQuantity] = useState<number>(1);\n  const [logoFile, setLogoFile] = useState<string | null>(null);\n  const [logoPosition, setLogoPosition] = useState({ x: 200, y: 200 });\n\n  const [orderItems, setOrderItems] = useState<OrderItem[]>([]);\n  const [customerInfo, setCustomerInfo] = useState<CustomerInfo>({\n    companyName: \"\",\n    contact: \"\",\n    phone: \"\",\n    email: \"\",\n    deliveryDate: \"\",\n  });\n\n  /* ---------------------------\n     Cargar productos desde CSV\n     --------------------------- */\n  useEffect(() => {\n    fetch(\"/Products.csv\")\n      .then((r) => r.text())\n      .then((csvText) => {\n        Papa.parse(csvText, {\n          header: true,\n          skipEmptyLines: true,\n          complete: (result) => {\n            const parsed = result.data as any[];\n            const prods: Product[] = parsed.map((row, i) => ({\n              id: i + 1,\n              name: row.name,\n              basePrice: parseFloat(row.basePrice || 0),\n              image: row.image,\n            }));\n            setProducts(prods);\n            if (prods.length > 0) setSelectedProduct(prods[0]);\n          },\n        });\n      });\n  }, []);\n\n  /* ---------------------------\n     Handlers\n     --------------------------- */\n  const handleLogoUpload = (e: ChangeEvent<HTMLInputElement>) => {\n    const f = e.target.files?.[0];\n    if (!f) return;\n    const reader = new FileReader();\n    reader.onload = () => {\n      setLogoFile(reader.result as string);\n      setLogoPosition({ x: 200, y: 200 });\n    };\n    reader.readAsDataURL(f);\n  };\n\n  const handlePreviewClickPosition = (e: React.MouseEvent<HTMLDivElement>) => {\n    const el = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - el.left;\n    const y = e.clientY - el.top;\n    setLogoPosition({ x, y });\n  };\n\n  const handleAddToOrder = () => {\n    if (!selectedProduct) return;\n    const newItem: OrderItem = {\n      id: Date.now(),\n      product: selectedProduct,\n      color: \"#FFFFFF\",\n      size: selectedSize,\n      quantity,\n      logo: logoFile,\n      logoPosition,\n      subtotal: selectedProduct.basePrice * quantity,\n    };\n    setOrderItems((prev) => [...prev, newItem]);\n    setLogoFile(null);\n    setLogoPosition({ x: 200, y: 200 });\n    setQuantity(1);\n  };\n\n  const updateOrderItem = (id: number, field: keyof OrderItem, value: any) => {\n    setOrderItems((prev) =>\n      prev.map((it) => {\n        if (it.id !== id) return it;\n        const updated = { ...it, [field]: value } as OrderItem;\n        if (field === \"quantity\") {\n          const q = Number(value) || 0;\n          updated.subtotal = updated.product.basePrice * q;\n          updated.quantity = q;\n        }\n        return updated;\n      })\n    );\n  };\n\n  const removeOrderItem = (id: number) => {\n    setOrderItems((prev) => prev.filter((it) => it.id !== id));\n  };\n\n  const getTotalOrder = () => orderItems.reduce((s, it) => s + it.subtotal, 0);\n\n  /* ---------------------------\n     Export helpers\n     --------------------------- */\n  const capturePreviewAsBlob = async (\n    elementId: string\n  ): Promise<Blob | null> => {\n    const el = document.getElementById(elementId);\n    if (!el) return null;\n\n    const canvas = await html2canvas(el as HTMLElement, {\n      backgroundColor: null,\n      scale: 2,\n      useCORS: true,\n    });\n\n    return new Promise<Blob | null>((resolve) =>\n      canvas.toBlob((b) => resolve(b), \"image/png\")\n    );\n  };\n\n  const exportOrder = async () => {\n    if (orderItems.length === 0) {\n      alert(\"No puedes guardar una orden sin productos.\");\n      return;\n    }\n\n    const orderId = Date.now();\n    const now = new Date();\n    const orderMeta: Order = {\n      id: orderId,\n      customer: { ...customerInfo },\n      items: orderItems,\n      total: getTotalOrder(),\n      status: \"Pendiente\",\n      createdAt: now.toISOString(),\n    };\n\n    // 1) Capturar previews ocultos\n    for (let i = 0; i < orderItems.length; i++) {\n      const item = orderItems[i];\n      const blob = await capturePreviewAsBlob(`hidden-preview-${item.id}`);\n      if (blob) {\n        const filename = `order-${orderId}-${i + 1}.png`;\n        saveAs(blob, filename);\n      }\n    }\n\n    // 2) Excel con datos de la orden\n    const workbook = new ExcelJS.Workbook();\n    const worksheet = workbook.addWorksheet(\"Orders\");\n\n    worksheet.columns = [\n      { header: \"ID\", key: \"id\", width: 18 },\n      { header: \"companyName\", key: \"companyName\", width: 25 },\n      { header: \"contact\", key: \"contact\", width: 20 },\n      { header: \"phone\", key: \"phone\", width: 15 },\n      { header: \"email\", key: \"email\", width: 25 },\n      { header: \"deliveryDate\", key: \"deliveryDate\", width: 18 },\n      { header: \"productName\", key: \"productName\", width: 25 },\n      { header: \"linkImg\", key: \"linkImg\", width: 30 },\n      { header: \"color\", key: \"color\", width: 10 },\n      { header: \"size\", key: \"size\", width: 10 },\n      { header: \"quantity\", key: \"quantity\", width: 10 },\n      { header: \"basePrice\", key: \"basePrice\", width: 12 },\n      { header: \"subtotal\", key: \"subtotal\", width: 12 },\n      { header: \"status\", key: \"status\", width: 12 },\n    ];\n\n    orderItems.forEach((item, idx) => {\n      const filename = `order-${orderId}-${idx + 1}.png`;\n      worksheet.addRow({\n        id: `${orderId}-${idx + 1}`,\n        companyName: orderMeta.customer.companyName,\n        contact: orderMeta.customer.contact,\n        phone: orderMeta.customer.phone,\n        email: orderMeta.customer.email,\n        deliveryDate: orderMeta.customer.deliveryDate || \"\",\n        productName: item.product.name,\n        linkImg: filename,\n        color: item.color,\n        size: item.size,\n        quantity: item.quantity,\n        basePrice: item.product.basePrice,\n        subtotal: item.subtotal,\n        status: orderMeta.status,\n      });\n    });\n\n    const buffer = await workbook.xlsx.writeBuffer();\n    saveAs(new Blob([buffer]), `orderData-${orderId}.xlsx`);\n\n    alert(`Orden ${orderId} exportada correctamente.`);\n    setOrderItems([]);\n    setCustomerInfo({\n      companyName: \"\",\n      contact: \"\",\n      phone: \"\",\n      email: \"\",\n      deliveryDate: \"\",\n    });\n  };\n\n  /* ===========================\n     JSX\n     =========================== */\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold mb-4\">Sistema de Órdenes</h1>\n\n      {/* Sección productos */}\n      <div className=\"mb-4 flex items-center space-x-2\">\n        <select\n          value={selectedProduct?.id || \"\"}\n          onChange={(e) =>\n            setSelectedProduct(\n              products.find((p) => p.id === Number(e.target.value)) || null\n            )\n          }\n          className=\"border p-2 rounded\"\n        >\n          {products.map((p) => (\n            <option key={p.id} value={p.id}>\n              {p.name} (${p.basePrice})\n            </option>\n          ))}\n        </select>\n\n        <input\n          type=\"number\"\n          value={quantity}\n          min={1}\n          onChange={(e) => setQuantity(Number(e.target.value))}\n          className=\"border p-2 w-20\"\n        />\n\n        <select\n          value={selectedSize}\n          onChange={(e) => setSelectedSize(e.target.value)}\n          className=\"border p-2\"\n        >\n          <option value=\"S\">S</option>\n          <option value=\"M\">M</option>\n          <option value=\"L\">L</option>\n        </select>\n\n        <input type=\"file\" accept=\"image/*\" onChange={handleLogoUpload} />\n\n        <button\n          onClick={handleAddToOrder}\n          className=\"px-4 py-2 bg-blue-500 text-white rounded flex items-center\"\n        >\n          <ShoppingCart className=\"mr-2\" /> Agregar\n        </button>\n      </div>\n\n      {/* Vista previa grande */}\n      <div className=\"bg-white rounded-lg p-6 shadow-lg flex flex-col items-center\">\n        <h3 className=\"text-xl font-bold mb-4 flex items-center\">\n          <Eye className=\"mr-2\" /> Vista Previa\n        </h3>\n        {selectedProduct ? (\n          <ProductPreview\n            product={selectedProduct}\n            color=\"#FFFFFF\"\n            logo={logoFile}\n            logoPos={logoPosition}\n            onClickPosition={handlePreviewClickPosition}\n            imageUrl={selectedProduct?.image}\n            id={\"preview-selected\"}\n          />\n        ) : (\n          <p className=\"text-gray-500\">Selecciona un producto</p>\n        )}\n      </div>\n\n      {/* Items en la orden */}\n      <div className=\"mt-6 space-y-4\">\n        {orderItems.map((item) => (\n          <div\n            key={item.id}\n            className=\"border rounded p-4 flex items-center space-x-4\"\n          >\n            <div style={{ width: 120, height: 120 }}>\n              <ProductPreview\n                product={item.product}\n                color={item.color}\n                logo={item.logo}\n                logoPos={item.logoPosition}\n                imageUrl={item.product.image}\n              />\n            </div>\n            <div>\n              <p className=\"font-bold\">{item.product.name}</p>\n              <p>\n                Cantidad:{\" \"}\n                <input\n                  type=\"number\"\n                  value={item.quantity}\n                  min={1}\n                  onChange={(e) =>\n                    updateOrderItem(item.id, \"quantity\", Number(e.target.value))\n                  }\n                  className=\"w-16 border p-1 ml-2\"\n                />\n              </p>\n              <p>Subtotal: ${item.subtotal}</p>\n              <button\n                onClick={() => removeOrderItem(item.id)}\n                className=\"text-red-500 mt-2 flex items-center\"\n              >\n                <Trash2 size={16} className=\"mr-1\" /> Eliminar\n              </button>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Resumen */}\n      <div className=\"mt-6\">\n        <h2 className=\"text-xl font-bold\">Resumen de Orden</h2>\n        <p>Total: ${getTotalOrder()}</p>\n        <button\n          onClick={exportOrder}\n          className=\"mt-2 px-4 py-2 bg-green-500 text-white rounded flex items-center\"\n        >\n          <Save className=\"mr-2\" /> Guardar Orden\n        </button>\n      </div>\n\n      {/* Previews ocultos (para exportación) */}\n      <div style={{ position: \"absolute\", left: \"-9999px\", top: 0 }}>\n        {orderItems.map((item) => (\n          <div\n            key={`hidden-preview-${item.id}`}\n            id={`hidden-preview-${item.id}`}\n            style={{ width: 400, height: 400 }}\n          >\n            <ProductPreview\n              product={item.product}\n              color={item.color}\n              logo={item.logo}\n              logoPos={item.logoPosition}\n              imageUrl={item.product.image}\n            />\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default OrderManagementSystem;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}